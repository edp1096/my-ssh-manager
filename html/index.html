<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>SSH Manager</title>
    <link rel="icon" href="data:,">

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/host-list.css" />
    <link rel="stylesheet" href="/css/dialog.css" />
</head>

<body oncontextmenu="contextMenu(event); return false" onmousewheel="preventCtrlWheel(event)" onkeydown="preventKeys(event)">
    <button onclick="appendCategory()">Add category</button>
    <button onclick="getHosts()">Refresh host list</button>
    <button onclick="openChangePasswordDialog()">Change password</button>

    <hr />

    <div id="hosts-data-container"></div>

    <dialog id="dialog-host-edit" onclose="saveHostData(event)"></dialog>
    <dialog id="dialog-notice"></dialog>

    <dialog id="dialog-enter-password" onclose="enterPassword()">
        <h2>Enter password</h2>
        <form method="dialog">
            <p>
                <label for="enter-password-input">Password:</label>
                <input type="password" id="enter-password-input" name="enter-password" required autocomplete="off" />
            </p>

            <p>
                <button value="confirm">Submit</button>
            </p>
        </form>
    </dialog>

    <dialog id="dialog-change-password" onclose="changeHostFilePassword(event)">
        <h2>Change password</h2>
        <form method="dialog">
            <p>
                <label for="enter-password-input">Previous password:</label>
                <input type="password" id="change-password-old" name="password-old" required autocomplete="off" />
            </p>
            <p>
                <label for="enter-password-input">New password:</label>
                <input type="password" id="change-password-new" name="password-new" required autocomplete="off" />
            </p>

            <p>
                <button type="button" onclick="cancelChangePasswordDialog()">Cancel</button>
                <button value="confirm">Submit</button>
            </p>
        </form>
    </dialog>

    <template id="category-edit-template">
        <input id="category-name" />
    </template>

    <template id="category-buttons-template">
        <button onclick="openHostEditDialog(`@@_CATEGORY_IDX_@@`)">Add host</button>
        <button onclick="alert('Not yet')">Rename category</button>
        <button onclick="alert('Not yet')">Delete category</button>
    </template>

    <template id="category-data-template">
        <ul class="categories">
            <li class="category">
                <span class="category-name">@@_CATEGORY_NAME_@@</span>
                <span class="buttons">@@_CATEGORY_BUTTONS_@@</span>
                @@_HOST_DATA_@@
            </li>
        </ul>
    </template>

    <template id="hosts-data-template">
        <ul class="host-part-info" ondblclick="connectSSH(`@@_IDX_@@`, `new_window`)" onmousedown="return false">
            <li class="part-name">
                <span class="label">Name:</span> <span>@@_NAME_@@</span>
            </li>
            <li class="part-address">
                <span class="label">Address:</span> <span>@@_ADDRESS_@@:@@_PORT_@@</span>
            </li>
            <li>
                <button onclick="connectSSH(`@@_IDX_@@`, `new_window`)">Open new window</button>
                <button onclick="connectSSH(`@@_IDX_@@`)">Open new panel</button>
                <span class="button-section-divider">|</span>
                <button onclick="openHostEditDialog(`@@_IDX_@@`)">Edit</button>
                <button onclick="deleteHost(`@@_IDX_@@`)">Delete</button>
            </li>
        </ul>
    </template>

    <template id="dialog-host-edit-template">
        <h2>@@_TITLE_@@</h2>
        <form method="dialog">
            <input type="hidden" id="category-idx" value="" />
            <input type="hidden" id="idx" value="" />
            <input type="hidden" id="auth-type-orig" value="" />
            <div>
                <label for="host-edit-name">Name:</label>
                <input type="text" id="host-edit-name" name="name" required autocomplete="off" />
            </div>
            <div>
                <label for="host-edit-address">Address:</label>
                <input id="host-edit-address" name="address" required autocomplete="off" placeholder="IP or domain" />
            </div>
            <div>
                <label for="host-edit-port">Port:</label>
                <input id="host-edit-port" type="number" name="port" autocomplete="off" placeholder="22 is default if empty" />
            </div>
            <div>
                <label for="host-edit-username">Username:</label>
                <input id="host-edit-username" name="username" required autocomplete="off" />
            </div>

            <hr />

            <div>
                <label for="use-password">Password</label><input onchange="setAuthType()" type="radio" id="use-password" name="auth-type" checked />
                <label for="use-private-key-text">Private Key</label><input onchange="setAuthType()" type="radio" id="use-private-key-text" name="auth-type" />
            </div>
            <div>
                <label for="host-edit-password">Password:</label>
                <input type="password" id="host-edit-password" name="password" required />
            </div>

            <div>
                <label for="host-edit-private-key-file">Private keyðŸ“‚:</label>
                <input type="file" id="host-edit-private-key-file" onchange="moveKeyFileToPrivateKeyText(event)" />
                <textarea id="host-edit-private-key-text" name="private-key-text" required></textarea>
            </div>

            <div>
                <label for="host-edit-description">Description:</label>
                <textarea id="host-edit-description" name="description"></textarea>
            </div>

            <div>
                <button type="button" onclick="cancelHostEditDialog()">Cancel</button>
                <button value="confirm">Save</button>
            </div>
        </form>
    </template>

    <template id="dialog-notice-template">
        <div style="width: 15rem; height: 10rem;">
            <p>@@_MESSAGE_@@</p>
            <button onclick="closeNotice(event)">Close</button>
        </div>
    </template>
</body>

<script>"use strict"</script>
<script src="/js/consts.js"></script>
<script src="/js/ws.js"></script>
<script src="/js/input-events.js"></script>
<script src="/js/host-control.js"></script>
<script src="/js/scripts.js"></script>

</html>